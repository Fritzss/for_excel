# Groups2Sheets Excel Processor

Скрипт для разделения листа Excel с группировкой строк на отдельные листы по группам с сохранением форматирования.

## Особенности
- Автоматическое определение групп строк по структуре документа
- Сохранение стилей ячеек, объединенных областей и ширины столбцов
- Поддержка прогресс-баров для отслеживания процесса
- Гибкая настройка через файл конфигурации
- Возможность сборки в исполняемый файл (.exe)

## Требования
- Python 3.7+
- Windows (рекомендуется) или Linux/macOS

## Установка
1. Склонируйте репозиторий:
   ```bash
   git clone https://github.com/ваш-репозиторий.git
   ```

## Установите зависимости:

```bash
pip install -r requirements.txt
```

## Конфигурация

Создайте файл config.ini в формате:

```
[Settings]
src_file = исходный_файл.xlsx
sheet = Имя_листа
dst_folder = папка_назначения  # (не используется в текущей версии)
tag = Маркер_окончания # опционально
```

## Использование

Запустите скрипт командой:

```shell
python groups2sheets.py
```

Результат будет сохранен в файле ./groups2sheets-исходный_файл.xlsx с отдельными листами для каждой группы.

## Сборка в исполняемый файл

Для сборки .exe файла выполните:

```powershell
.\convert2exe.ps1
```

Требуется:

* PowerShell

* Доступ в интернет (для установки зависимостей)

## Особенности работы

Определяет группы по уровням группировки строк

Копирует:

* Заголовки документа

* Все стили форматирования

* Объединенные ячейки

* Ширину столбцов

* Высоту строк

* Автоматически определяет кодировку config.ini

* Сворачивает группы при копировании

# Ограничения

Требуется строгая иерархия группировки (0 → 1)

Маркер окончания (tag) должен быть уникальным

# Поддерживаемые форматы

.xlsx (Excel 2007+)

### Примечания:

1. Для сборки в .exe требуется дополнительно:
   - PyInstaller
   - Иконка (должна присутствовать в папке проекта)
   
2. Конфигурация по умолчанию:
   - Исходный файл: `test.xlsx`
   - Лист: `Лист_1`
   - Маркер окончания: `test1`

3. Результат работы сохраняется в файл с префиксом `groups2sheets-` в имени исходного файла.
